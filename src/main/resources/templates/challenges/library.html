<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="layout/default">
<th:block layout:fragment="css">
</th:block>
<th:block layout:fragment="script">
</th:block>

<div layout:fragment="content">
    <div class="container-fluid text-left" style="width: 75%; margin-bottom:5%;">
        <div class="text">
            <img th:src="@{/images/userprofile/profile-default.png}" height="200" width="200"/>
        </div>
        <div class="text-center"><span style="color: black; size: 35px;" th:text="${user.name}"></span></div>
        <div class="text-center"><span style="color: black; size: 35px;" th:text="${user.comment}"></span></div>

        <div class="text">
            <button class="btn btn-dark" onclick="doneread();">읽은 책들</button>
            <button class="btn btn-dark" onclick="reading();">읽고 있는 책들</button>
            <button class="btn btn-dark">북마크</button>
        </div>
        <div class="text" id="challenge">

        </div>
    </div>
    <script th:inline="javascript">
        /*<![CDATA[*/
        var userId =/*[[${user.id}]]*/ 'default';

        function doneread() {
            var bookStatus = '완료';
            $.ajax({
                type: 'get',
                url: '/api/challenge?userId=' + userId + '&bookStatus=' + bookStatus,
                async: false,
                contentType: "application/json",
                error: function () {
                    alert('와!에러!와!일해라!');
                },
                success: function (data) {

                    console.log(data);
                    for (var i = 0; i < data.length; i++) {
                        var challengeDiv = $('<div class="text-center"> title : ' + data[i].booksTitle + ' start Date: ' + data[i].startDate + ' end date: ' + data[i].endDate + ' status : ' + data[i].bookStatus + '</div>');
                        challengeDiv.appendTo($('#challenge'));
                    }
                    return false;
                }
            });

        }

        function reading() {

            var bookStatus = '읽는중';
            $.ajax({
                type: 'get',
                url: '/api/challenge?userId=' + userId + '&bookStatus=' + bookStatus,
                async: false,
                contentType: "application/json",
                error: function () {
                    alert('와!에러!와!일해라!');
                },
                success: function (data) {

                    console.log(data);
                    for (var i = 0; i < data.length; i++) {
                        var challengeDiv = $('<div class="text-center"> title : ' + data[i].booksTitle + ' start Date: ' + data[i].startDate + ' end date: ' + data[i].endDate + ' status : ' + data[i].bookStatus + '</div>');
                        challengeDiv.appendTo($('#challenge'));
                    }
                    return false;
                }
            });

        }
        // $(document).ready(function() {
        //     var userId =/*[[${user.id}]]*/ 'default';
        //     $.ajax({
        //         type: 'get',
        //         url:'/api/challenge?userId='+userId,
        //         async: false,
        //         contentType: "application/json",
        //         error: function(){
        //             alert('와!에러!와!일해라!');
        //         },
        //         success: function(data){
        //             console.log(data);
        //             for(var i = 0; i < data.length; i++){
        //                 var challengeDiv = $('<div class="text-center"> title : ' + data[i].booksTitle + ' start Date: ' + data[i].startDate + ' end date: ' +  data[i].endDate + ' status : ' + data[i].bookStatus +  '</div>');
        //                 challengeDiv.appendTo($('#challenge'));
        //             }
        //         }
        //     })
        // });
        /*]]>*/
    </script>
</div>
</html>